<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photocopieurs (MFP) en 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .card {
            background-color: white;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 2.5rem;
            margin-bottom: 2rem;
        }
        .card-header {
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .text-section {
            display: none;
        }
        .active-section {
            display: block;
        }
        .nav-button {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .nav-button.active {
            background-color: #1B2D5B;
            color: white;
        }
        .nav-button:not(.active) {
            color: #1f2937;
        }
        .nav-button:not(.active):hover {
            background-color: #f3f4f6;
            color: #1a202c;
        }
        .grid-flow-row {
            grid-auto-flow: row;
        }
        .table-custom th, .table-custom td {
            text-align: left;
            padding: 0.75rem;
        }
        .table-custom thead {
            background-color: #f9fafb;
        }
        .tooltip {
            position: absolute;
            background-color: #1B2D5B;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            z-index: 10;
            white-space: nowrap;
            display: none;
            pointer-events: none;
            transform: translate(-50%, -120%);
            left: 50%;
        }
        tr:hover .tooltip {
            display: block;
        }
        tr {
            position: relative;
        }
        .text-center {
          text-align: center;
        }
        .highlighted-card {
            background-color: #e0f2fe;
            border: 2px solid #3b82f6;
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.5), 0 2px 4px -1px rgba(59, 130, 246, 0.25);
        }
        .highlighted-card:hover {
            background-color: #FFFFE0;
            border: 2px solid #FFFF00;
            box-shadow: 0 6px 8px -1px rgba(255, 255, 0, 0.3), 0 3px 5px -1px rgba(255, 255, 0, 0.2);
            transform: translateY(-2px);
            transition: all 0.2s ease-in-out;
        }
        .highlighted-row {
            background-color: #e0f2fe;
            transition: all 0.2s ease-in-out;
        }
        .highlighted-row:hover {
            background-color: #FFFFE0;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(255, 255, 0, 0.3), 0 2px 4px -1px rgba(255, 255, 0, 0.2);
        }
        .total-row {
            font-weight: bold;
            background-color: #f9fafb;
            border-top: 2px solid #e5e7eb;
        }
        .sortable {
            cursor: pointer;
            position: relative;
        }
        .sort-icon {
            margin-left: 8px;
            font-size: 0.75rem;
            color: #6b7280;
            opacity: 0.2;
            transition: opacity 0.2s ease-in-out;
        }
        .sortable:hover .sort-icon {
            opacity: 1;
        }
        .sortable.active .sort-icon {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-8">
        <h1 class="text-4xl font-bold text-center text-[#1B2D5B] mb-2">
            Photocopieurs (MFP) en 2025
        </h1>
        <p class="text-xl text-center text-[#2CA1AC] mb-8">
            Optimisation et adaptation du parc de photocopieurs au sein du SFPD
        </p>

        <div class="flex justify-center mb-8 flex-wrap">
            <button id="btn-bureaux" class="nav-button active px-6 py-3 mx-2 rounded-full font-semibold bg-[#1B2D5B] text-white shadow-lg my-1">Bureaux régionaux</button>
            <button id="btn-tour" class="nav-button px-6 py-3 mx-2 rounded-full font-semibold bg-gray-200 text-gray-900 shadow-lg my-1">Tour du Midi</button>
            <button id="btn-catalogue" class="nav-button px-6 py-3 mx-2 rounded-full font-semibold bg-gray-200 text-gray-800 shadow-lg my-1">Catalogue Forcms</button>
            <button id="btn-leasing" class="nav-button px-6 py-3 mx-2 rounded-full font-semibold bg-gray-200 text-gray-800 shadow-lg my-1">Calcul du coût du leasing</button>
            <button id="btn-modele" class="nav-button px-6 py-3 mx-2 rounded-full font-semibold bg-gray-200 text-gray-800 shadow-lg my-1">Modèle recommandé</button>
        </div>

        <!-- Section Bureaux régionaux -->
        <div id="section-bureaux" class="text-section active-section card">
            <div class="card-header">
                <h2 class="text-2xl font-semibold text-[#1B2D5B]">Bureaux régionaux : analyse et proposition</h2>
            </div>
            
            

            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Proposition d'adaptation du volume</h3>
            <p class="text-sm text-gray-700 mb-2">
                La proposition vise à réduire le nombre de photocopieurs de <span class="font-bold">52 à 42</span> en se basant sur la localisation (nombre d'étages, machine par accueil).
            </p>
            <p class="text-xs text-gray-500 italic mb-6">
                Sous réserve des synergies et des ajustements des besoins recensés, la proposition est établie sur base des informations actuellement disponibles.
            </p>

            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Volume moyen des impressions en 2025 (janv - août)</h3>
            <p class="text-sm text-gray-600 mb-4">Le graphique à barres ci-dessous classe les 13 bureaux régionaux en fonction de leur volume d'impression moyen sur les 8 premiers mois de 2025, du plus élevé au moins élevé.</p>
            <div class="bg-gray-50 rounded-lg p-6 mb-8">
                <canvas id="bureauxChart"></canvas>
            </div>
            
            <p class="text-sm text-gray-600 mb-4">
                Le fichier avec l'ensemble des données par MFP et par bureau régional peut être consulté via <a href="https://gcloudbelgium-my.sharepoint.com/:x:/g/personal/julien_nicaise_sfpd_fgov_be/ERO-1Fe4LWhDtHUWDoPJWAKABqhcYrnb0OOJcEwsTH2ZBTA?e=0iBxVB" target="_blank" class="text-[#2CA1AC] underline">ce lien</a>.
            </p>
            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Volume total des impressions</h3>
            <p class="text-sm text-gray-700 mb-2">
                Le total cumulé pour l'ensemble des 13 bureaux pour les 8 premiers mois de 2025 est le suivant :
            </p>
            <ul class="list-disc list-inside text-sm text-gray-700 mb-6">
                <li><span class="font-bold">Total des impressions :</span> 131 004</li>
                <li><span class="font-bold">Total en noir et blanc :</span> 73 915 (<span class="text- font-bold text-[#2CA1AC]">56,4%</span>)</li>
                <li><span class="font-bold">Total en couleur :</span> 57 089 (<span class="text- font-bold text-[#B71E4C]">43,6%</span>)</li>
				<li><span class="font-bold">Nombre de pages moyenne par agent :</span> 270 pages/an (485 personnes)</li>
            </ul>
            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Récapitulatif et proposition d'adaptation</h3>
            <div class="overflow-x-auto">
                <table id="bureauxTable" class="w-full table-auto border-collapse table-custom">
                    <thead>
                        <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                            <th class="py-3 px-6 sortable" data-sort-key="label">Bureau<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="value">Moyenne (janv.-août)<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="mfp">MFP actuels<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="proposed">Proposition<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="difference">Différence<span class="sort-icon">&#x25B2;</span></th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-600 text-sm font-light">
                        <!-- Table rows will be inserted by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="mt-8 flex justify-center">
                <img src="https://i.ibb.co/4ZcMhrp6/logo.png" alt="Logo de l'entreprise" class="h-[100px] w-auto">
            </div>
        </div>

        <!-- Section Tour du Midi -->
        <div id="section-tour" class="text-section card">
            <div class="card-header">
                <h2 class="text-2xl font-semibold text-[#1B2D5B]">Tour du Midi : analyse et proposition</h2>
            </div>
            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Proposition d'adaptation du volume</h3>
            <p class="text-sm text-gray-700 mb-2">
                La proposition se base sur la consommation, visant à réduire le nombre de photocopieurs de <span class="font-bold">78 à 48</span>. L'objectif est de ne conserver qu'un seul MFP par étage, avec des exceptions pour les étages à forte consommation.
            </p>
            <p class="text-xs text-gray-500 italic mb-6">
                Sous réserve des synergies et des ajustements des besoins recensés, la proposition est établie sur base des informations actuellement disponibles.
            </p>

            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Volume moyen des impressions en 2025 (janv - août)</h3>
            <p class="text-sm text-gray-600 mb-4">Le graphique à barres ci-dessous classe les étages de la Tour du Midi en fonction de leur volume d'impression moyen sur les 8 premiers mois de 2025, du plus élevé au moins élevé.</p>
            <div class="bg-gray-50 rounded-lg p-6 mb-8">
                <canvas id="tourChart"></canvas>
            </div>

            <p class="text-sm text-gray-600 mb-4">
                Le fichier avec l'ensemble des données par MFP et par étage peut être consulté via <a href="https://gcloudbelgium-my.sharepoint.com/:x:/g/personal/julien_nicaise_sfpd_fgov_be/EYMosbmTTJhMqQ1-xE_LIiUBGiom7gahd15ltVMcQW55tg?e=IP5cka" target="_blank" class="text-[#2CA1AC] underline">ce lien</a>.
            </p>
<h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Volume total des impressions</h3>
            <p class="text-sm text-gray-700 mb-2">
                Le total cumulé pour l'ensemble des 37 étages pour les 8 premiers mois de 2025 est le suivant :
            </p>
            <ul class="list-disc list-inside text-sm text-gray-700 mb-6">
                <li><span class="font-bold">Total des impressions :</span> 700 219</li>
                <li><span class="font-bold">Total en noir et blanc :</span> 353 601 (<span class="text- font-bold text-[#2CA1AC]">50,5%</span>)</li>
                <li><span class="font-bold">Total en couleur :</span> 346 618 (<span class="text- font-bold text-[#B41E4C]">49,5%</span>)</li>
				<li><span class="font-bold">Nombre de pages moyenne par agent :</span> 414 pages/an (1693 personnes)</li>
            </ul>
            <h3 class="text-xl font-semibold text-[#B71E4C] mb-4">Récapitulatif et proposition d'adaptation</h3>
            <div class="overflow-x-auto">
                <table id="tourTable" class="w-full table-auto border-collapse table-custom">
                    <thead>
                        <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                            <th class="py-3 px-6 sortable" data-sort-key="label">Étage<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="value">Moyenne (janv.-août)<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="mfp">MFP actuels<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="proposed">Proposition<span class="sort-icon">&#x25B2;</span></th>
                            <th class="py-3 px-6 sortable" data-sort-key="difference">Différence<span class="sort-icon">&#x25B2;</span></th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-600 text-sm font-light">
                        <!-- Table rows will be inserted by JavaScript -->
                    </tbody>
                </table>
            </div>

            <div class="mt-8 flex justify-center">
                <img src="https://i.ibb.co/4ZcMhrp6/logo.png" alt="Logo de l'entreprise" class="h-[100px] w-auto">
            </div>
        </div>
        
        <!-- Section Catalogue Forcms -->
        <div id="section-catalogue" class="text-section card">
            <div class="card-header">
                <h2 class="text-2xl font-semibold text-[#1B2D5B]">Catalogue Forcms : caractéristiques des modèles</h2>
            </div>
            <p class="text-lg mb-4">
                Voici les caractéristiques principales des modèles de photocopieurs multifonctions disponibles.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm highlighted-card">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM C3010A</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 2 518,02 €<br>
                        <span class="font-semibold">Vitesse :</span> 30 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~5 000 – 15 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0220 € (Couleur) / 0,0029 € (Mono)
                    </p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM C3510A</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 2 923,63 €<br>
                        <span class="font-semibold">Vitesse :</span> 35 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~20 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0220 € / 0,0029 €
                    </p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM 4000A (Mono)</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 2 653,58 €<br>
                        <span class="font-semibold">Vitesse :</span> 40 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~7 000 – 15 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0041 € (Mono)
                    </p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM C4510A</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 3 120,60 €<br>
                        <span class="font-semibold">Vitesse :</span> 45 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~7 000 – 12 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0220 € / 0,0029 €
                    </p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM 5000A (Mono)</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 2 864,87 €<br>
                        <span class="font-semibold">Vitesse :</span> 50 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~10 000 – 20 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0041 € (Mono)
                    </p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM C5510A</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 2 887,39 €<br>
                        <span class="font-semibold">Vitesse :</span> 55 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~10 000 – 25-30 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0220 € / 0,0029 €
                    </p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">IM C6010A</h3>
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Prix TVAC:</span> 4 753,84 €<br>
                        <span class="font-semibold">Vitesse :</span> 60 ppm<br>
                        <span class="font-semibold">Volume recommandé :</span> ~15 000 – 30 000 impressions/mois<br>
                        <span class="font-semibold">Coût par page :</span> 0,0220 € / 0,0029 €
                    </p>
                </div>
            </div>
				<div class="mt-8 flex justify-center">
                <img src="https://i.ibb.co/4ZcMhrp6/logo.png" alt="Logo de l'entreprise" class="h-[100px] w-auto">
            </div>						 
        </div>

        <div id="section-leasing" class="text-section card">
            <div class="card-header">
                <h2 class="text-2xl font-semibold text-[#1B2D5B]">Calcul du coût du leasing - Modèle IMC 3010A</h2>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full table-auto border-collapse">
                    <thead>
                        <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                            <th class="py-3 px-6">Durée<sup>(1)</sup></th>
                            <th class="py-3 px-6">Coefficient Locatif</th>
                            <th class="py-3 px-6">Prix TVAC</th>
                            <th class="py-3 px-6">Prix mensuel TVAC hors coût d’impression</th>
                            <th class="py-3 px-6">Coût total TVAC en fonction de la durée du contrat</th>
                            <th class="py-3 px-6">Coût du support</th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-600 text-sm font-light text-center">
                        <tr class="border-b border-gray-200 hover:bg-gray-100">
                            <td class="py-3 px-6 font-bold">12 mois</td>
                            <td class="py-3 px-6">0.086066</td>
                            <td class="py-3 px-6">2 518,02 €</td>
                            <td class="py-3 px-6">216,68 €</td>
                            <td class="py-3 px-6">2 600,16 €</td>
                            <td class="py-3 px-6">82,14 €</td>
                        </tr>
                        <tr class="border-b border-gray-200 hover:bg-gray-100">
                            <td class="py-3 px-6 font-bold">24 mois</td>
                            <td class="py-3 px-6">0.044321</td>
                            <td class="py-3 px-6">2 518,02 €</td>
                            <td class="py-3 px-6">111,61 €</td>
                            <td class="py-3 px-6">2 678,64 €</td>
                            <td class="py-3 px-6">160,62 €</td>
                        </tr>
                        <tr class="border-b border-gray-200 hover:bg-gray-100">
                            <td class="py-3 px-6 font-bold">36 mois</td>
                            <td class="py-3 px-6">0.030422</td>
                            <td class="py-3 px-6">2 518,02 €</td>
                            <td class="py-3 px-6">76,63 €</td>
                            <td class="py-3 px-6">2 758,68 €</td>
                            <td class="py-3 px-6">240,66 €</td>
                        </tr>
                        <tr class="border-b border-gray-200 hover:bg-gray-100">
                            <td class="py-3 px-6 font-bold">48 mois</td>
                            <td class="py-3 px-6">0.023485</td>
                            <td class="py-3 px-6">2 518,02 €</td>
                            <td class="py-3 px-6">59,14 €</td>
                            <td class="py-3 px-6">2 839,02 €</td>
                            <td class="py-3 px-6">321,00 €</td>
                        </tr>
                        <tr class="border-b border-gray-200 highlighted-row">
                            <td class="py-3 px-6 font-bold">60 mois</td>
                            <td class="py-3 px-6">0.019333</td>
                            <td class="py-3 px-6">2 518,02 €</td>
                            <td class="py-3 px-6">48,68 €</td>
                            <td class="py-3 px-6">2 920,80 €</td>
                            <td class="py-3 px-6">402,78 €</td>
                        </tr>
                    </tbody>
                </table>
            </div>
			
			<p class="text-sm mb-3">
                <p> </p>
				(1) Une option de prolongation de la maintenance, pour une période de 1 à 3 ans après l’échéance du leasing, est disponible.
            </p>
            <div class="mt-8 flex justify-center">
                <img src="https://i.ibb.co/4ZcMhrp6/logo.png" alt="Logo de l'entreprise" class="h-[100px] w-auto">
            </div>
        </div>

        <div id="section-modele" class="text-section card">
            <div class="card-header">
                <h2 class="text-2xl font-semibold text-[#1B2D5B]">Modèle recommandé et coûts</h2>
            </div>
			
            <p class="text-sm mb-4">
                Après analyse du volume d’impression actuel et en tenant compte des spécifications des modèles proposés dans le catalogue, le modèle <span class="font-bold">IM C3010A</span> apparaît comme le choix le plus pertinent. Il couvre pleinement nos besoins, tant en termes de performance (vitesse) que de capacité de volume. Nous recommandons donc d’opter pour le leasing de ce modèle.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">Performance</h3>
                    <p>Vitesse : <span class="font-semibold">30 ppm</span></p>
                    <p>Volume mensuel recommandé : <span class="font-semibold">jusqu'à 20 000 impressions</span></p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">Coût par page</h3>
                    <p>Couleur : <span class="font-semibold">0,0220 €</span></p>
                    <p>Mono : <span class="font-semibold">0,0029 €</span></p>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-sm">
                    <h3 class="font-bold text-lg mb-2 text-[#1B2D5B]">Coût de leasing (60 mois)</h3>
                    <p>Mensuel : <span class="font-semibold">48,68 €</span></p>
                    <p>Total : <span class="font-semibold">2 920,80 €</span></p>
                </div>
            </div>

            <div class="mt-6 p-4 rounded-lg bg-yellow-50 border-l-4 border-yellow-500 text-sm text-yellow-800">
                <p class="font-semibold mb-2">Addendum :</p>
                <p>Précisons que le prix indiqué pour les MFP correspond au tarif de base (leasing seul). Le coût réel sera affiné lors de la réunion prévue avec Ricoh (19/09). Il conviendra probablement d’y ajouter les lecteurs de badge, ainsi que, le cas échéant, un module Wi-Fi (dont la pertinence reste à discuter). À noter également que la partie Streamline (Software) n’est pas incluse. Enfin, il faut également tenir compte du coût mensuel variable en fonction du nombre de pages imprimées (Mono & Couleurs)</p>
            </div>

            <div class="mt-8 flex justify-center">
                <img src="https://i.ibb.co/4ZcMhrp6/logo.png" alt="Logo de l'entreprise" class="h-[100px] w-auto">
            </div>
        </div>
    </div>
            
    <script>
        const bureauxData = [
            { label: 'Liège', value: 2318, mfp: 5, proposed: 3 },
            { label: 'Mons', value: 2207, mfp: 5, proposed: 4 },
            { label: 'Charleroi', value: 1677, mfp: 5, proposed: 4 },
            { label: 'Gent', value: 1544, mfp: 5, proposed: 4 },
            { label: 'Antwerpen', value: 1316, mfp: 6, proposed: 4 },
            { label: 'Hasselt', value: 1259, mfp: 5, proposed: 4 },
            { label: 'Malmedy', value: 1215, mfp: 2, proposed: 2 },
            { label: 'Mouscron', value: 1111, mfp: 2, proposed: 2 },
            { label: 'Namur', value: 1106, mfp: 4, proposed: 4 },
            { label: 'Brugge', value: 936, mfp: 4, proposed: 3 },
            { label: 'Kortrijk', value: 613, mfp: 4, proposed: 3 },
            { label: 'Turnhout', value: 610, mfp: 2, proposed: 2 },
            { label: 'Arlon', value: 465, mfp: 3, proposed: 3 },
        ];

        const tourData = [
            { label: 'A16', value: 11434, mfp: 6, proposed: 5 },
            { label: 'A22', value: 9927, mfp: 3, proposed: 3 },
            { label: 'A24', value: 8732, mfp: 2, proposed: 2 },
            { label: 'A17', value: 6945, mfp: 2, proposed: 1 },
            { label: 'A02', value: 4951, mfp: 3, proposed: 3 },
            { label: 'A09', value: 3510, mfp: 2, proposed: 2 },
            { label: 'A36', value: 3170, mfp: 2, proposed: 2 },
            { label: 'A15', value: 2909, mfp: 3, proposed: 2 },
            { label: 'A03', value: 2557, mfp: 1, proposed: 1 },
            { label: 'A34', value: 2400, mfp: 3, proposed: 1 },
            { label: 'A25', value: 2173, mfp: 2, proposed: 1 },
            { label: 'A11', value: 2066, mfp: 2, proposed: 1 },
            { label: 'B01', value: 1983, mfp: 2, proposed: 1 },
            { label: 'A10', value: 1923, mfp: 2, proposed: 1 },
            { label: 'A35', value: 1879, mfp: 2, proposed: 1 },
            { label: 'A13', value: 1813, mfp: 2, proposed: 1 },
            { label: 'A32', value: 1799, mfp: 2, proposed: 1 },
            { label: 'A23', value: 1691, mfp: 2, proposed: 1 },
            { label: 'B02', value: 1601, mfp: 3, proposed: 2 },
            { label: 'A29', value: 1512, mfp: 2, proposed: 1 },
            { label: 'A28', value: 1407, mfp: 2, proposed: 1 },
            { label: 'A12', value: 1297, mfp: 2, proposed: 1 },
            { label: 'A21', value: 1227, mfp: 2, proposed: 1 },
            { label: 'A31', value: 1207, mfp: 2, proposed: 1 },
            { label: 'A27', value: 1006, mfp: 2, proposed: 1 },
            { label: 'A00', value: 988, mfp: 1, proposed: 1 },
            { label: 'A20', value: 907, mfp: 2, proposed: 1 },
            { label: 'A14', value: 900, mfp: 2, proposed: 1 },
            { label: 'A26', value: 865, mfp: 2, proposed: 1 },
            { label: 'S01', value: 856, mfp: 1, proposed: 1 },
            { label: 'A18', value: 683, mfp: 1, proposed: 1 },
            { label: 'B00', value: 602, mfp: 2, proposed: 1 },
            { label: 'A30', value: 379, mfp: 2, proposed: 1 },
            { label: 'A05', value: 230, mfp: 3, proposed: 1 },
            { label: 'A19', value: 2, mfp: 1, proposed: 0 },
            { label: 'A04', value: 0, mfp: 3, proposed: 1 },
            { label: 'A33', value: 0, mfp: 0, proposed: 0 },
        ];
        
        let sortState = { key: 'value', direction: 'desc' };

        function renderTable(data, tableId) {
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';
            
            const dataWithDifference = data.map(row => {
                const difference = row.proposed - row.mfp;
                return { ...row, difference };
            });

            dataWithDifference.sort((a, b) => {
                const aValue = a[sortState.key];
                const bValue = b[sortState.key];

                if (sortState.key === 'label') {
                    if (aValue < bValue) return sortState.direction === 'asc' ? -1 : 1;
                    if (aValue > bValue) return sortState.direction === 'asc' ? 1 : -1;
                    return 0;
                } else {
                    return sortState.direction === 'asc' ? aValue - bValue : bValue - aValue;
                }
            });

            let totalMoyenne = 0;
            let totalMfpActuels = 0;
            let totalProposition = 0;
            let totalDifference = 0;

            dataWithDifference.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = 'border-b border-gray-200 hover:bg-gray-100';
                
                let tooltipText = "Pas de remarque";
                if (tableId === 'bureauxTable') {
                    if (row.label === 'Liège') { tooltipText = "Deux offline depuis le début de l'année. Ne gêne pas pour le travail"; }
                } else if (tableId === 'tourTable') {
                    if (row.label === 'A25') { tooltipText = "Une systématiquement éteinte"; }
                    else if (row.label === 'A04') { tooltipText = "Ouvriers (Logistic)"; }
                    else if (row.label === 'B02') { tooltipText = "Une pour le mess"; }
                    else if (row.label === 'A02') { tooltipText = "Accueil"; }
                    else if (row.label === 'A09') { tooltipText = "ARGO ?"; }
                    else if (row.label === 'A15') { tooltipText = "A vérifier"; }
                    else if (row.label === 'A30') { tooltipText = "La proposition est passée à 1 MFP."; }
                }

                tr.innerHTML = `
                    <td class="py-3 px-6">${row.label}</td>
                    <td class="py-3 px-6">${row.value}</td>
                    <td class="py-3 px-6">${row.mfp}</td>
                    <td class="py-3 px-6">${row.proposed}</td>
                    <td class="py-3 px-6 text-[#${row.difference < 0 ? 'B71E4C' : '2CA1AC'}]">${row.difference}</td>
                    <td class="tooltip">${tooltipText}</td>
                `;
                tableBody.appendChild(tr);

                totalMoyenne += row.value;
                totalMfpActuels += row.mfp;
                totalProposition += row.proposed;
                totalDifference += row.difference;
            });

            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td class="py-3 px-6">Total</td>
                <td class="py-3 px-6">${totalMoyenne}</td>
                <td class="py-3 px-6">${totalMfpActuels}</td>
                <td class="py-3 px-6">${totalProposition}</td>
                <td class="py-3 px-6">${totalDifference}</td>
                <td></td>
            `;
            tableBody.appendChild(totalRow);
        }

        function updateSortIndicators(tableId) {
            const headers = document.querySelectorAll(`#${tableId} .sortable`);
            headers.forEach(header => {
                const icon = header.querySelector('.sort-icon');
                if (header.dataset.sortKey === sortState.key) {
                    icon.style.opacity = '1';
                    header.classList.add('active');
                    icon.innerHTML = sortState.direction === 'asc' ? '&#x25B2;' : '&#x25BC;';
                } else {
                    icon.style.opacity = '0.2';
                    header.classList.remove('active');
                    icon.innerHTML = '&#x25B2;';
                }
            });
        }
        
        function handleSort(e) {
            const tableHeader = e.currentTarget;
            const sortKey = tableHeader.dataset.sortKey;
            const tableId = tableHeader.closest('table').id;

            if (sortState.key === sortKey) {
                sortState.direction = sortState.direction === 'asc' ? 'desc' : 'asc';
            } else {
                sortState.key = sortKey;
                sortState.direction = sortKey === 'label' ? 'asc' : 'desc';
            }

            if (tableId === 'bureauxTable') {
                renderTable(bureauxData, 'bureauxTable');
                updateSortIndicators('bureauxTable');
            } else {
                renderTable(tourData, 'tourTable');
                updateSortIndicators('tourTable');
            }
        }

        function createGradient(ctx, chartArea, color) {
            const gradient = ctx.createLinearGradient(0, chartArea.bottom, 0, chartArea.top);
            gradient.addColorStop(0, `${color}4D`);
            gradient.addColorStop(1, `${color}`);
            return gradient;
        }

        let bureauxChartInstance = null;
        let tourChartInstance = null;

        function createBureauxChart() {
            if (bureauxChartInstance) {
                bureauxChartInstance.destroy();
            }
            const sortedData = [...bureauxData].sort((a, b) => b.value - a.value);
            const ctx = document.getElementById('bureauxChart').getContext('2d');
            bureauxChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedData.map(d => d.label),
                    datasets: [{
                        label: 'Volume moyen des impressions en 2025 (janv - août)',
                        data: sortedData.map(d => d.value),
                        backgroundColor: function(context) {
                            const chart = context.chart;
                            const {ctx, chartArea} = chart;
                            if (!chartArea) {
                                return;
                            }
                            return createGradient(ctx, chartArea, '#1B2D5B');
                        },
                        borderColor: '#1B2D5B',
                        borderWidth: 1
                    }, {
                        label: 'Nombre de MFP actuels',
                        data: sortedData.map(d => d.mfp),
                        backgroundColor: '#2CA1AC',
                        borderColor: '#2CA1AC',
                        borderWidth: 1,
                        type: 'scatter',
                        pointStyle: 'rect',
                        radius: 8,
                        hoverRadius: 10,
                        pointBackgroundColor: '#2CA1AC',
                        pointBorderColor: '#2CA1AC',
                        pointBorderWidth: 2,
                        label: 'MFP actuels'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Volume d\'impressions'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if (context.datasetIndex === 1) {
                                        return `MFP actuels: ${context.raw}`;
                                    }
                                    return `Volume: ${context.raw}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createTourChart() {
            if (tourChartInstance) {
                tourChartInstance.destroy();
            }
            const sortedData = [...tourData].sort((a, b) => b.value - a.value);
            const ctx = document.getElementById('tourChart').getContext('2d');
            tourChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedData.map(d => d.label),
                    datasets: [{
                        label: 'Volume moyen des impressions en 2025 (janv - août)',
                        data: sortedData.map(d => d.value),
                        backgroundColor: function(context) {
                            const chart = context.chart;
                            const {ctx, chartArea} = chart;
                            if (!chartArea) {
                                return;
                            }
                            return createGradient(ctx, chartArea, '#1B2D5B');
                        },
                        borderColor: '#1B2D5B',
                        borderWidth: 1
                    }, {
                        label: 'Nombre de MFP actuels',
                        data: sortedData.map(d => d.mfp),
                        backgroundColor: '#2CA1AC',
                        borderColor: '#2CA1AC',
                        borderWidth: 1,
                        type: 'scatter',
                        pointStyle: 'rect',
                        radius: 8,
                        hoverRadius: 10,
                        pointBackgroundColor: '#2CA1AC',
                        pointBorderColor: '#2CA1AC',
                        pointBorderWidth: 2,
                        label: 'MFP actuels'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Volume d\'impressions'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if (context.datasetIndex === 1) {
                                        return `MFP actuels: ${context.raw}`;
                                    }
                                    return `Volume: ${context.raw}`;
                                }
                            }
                        }
                    }
                }
            });
        }


        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('.text-section');
            const navButtons = document.querySelectorAll('.nav-button');

            function showSection(sectionId) {
                sections.forEach(section => {
                    section.classList.remove('active-section');
                });
                const sectionElement = document.getElementById(sectionId);
                if (sectionElement) {
                    sectionElement.classList.add('active-section');
                }
            }

            function setActiveButton(buttonId) {
                navButtons.forEach(button => {
                    button.classList.remove('active');
                    button.classList.remove('bg-[#1B2D5B]', 'text-white');
                    button.classList.add('bg-gray-200', 'text-gray-900');
                });
                document.getElementById(buttonId).classList.add('active', 'bg-[#1B2D5B]', 'text-white');
                document.getElementById(buttonId).classList.remove('bg-gray-200', 'text-gray-900');
            }

            navButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const sectionId = `section-${e.target.id.split('-')[1]}`;
                    showSection(sectionId);
                    setActiveButton(e.target.id);
                    if (e.target.id === 'btn-bureaux') {
                        createBureauxChart();
                        renderTable(bureauxData, 'bureauxTable');
                        updateSortIndicators('bureauxTable');
                    } else if (e.target.id === 'btn-tour') {
                        createTourChart();
                        renderTable(tourData, 'tourTable');
                        updateSortIndicators('tourTable');
                    }
                });
            });

            document.querySelectorAll('.sortable').forEach(header => {
                header.addEventListener('click', handleSort);
            });

            // Initial rendering
            renderTable(bureauxData, 'bureauxTable');
            updateSortIndicators('bureauxTable');
            createBureauxChart();
        });
    </script>
</body>
</html>
